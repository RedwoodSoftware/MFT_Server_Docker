/* Copyright Â© 2009-2024. Redwood Software Inc. All rights reserved. */
jscape.AccountManagementService=jscape.ManagementService.extend({listUsers:function(startIndex,count,query){return this._request("GET","/accounts").matrix({start:startIndex,count:count}).send(query).then(function(data){return jscape.Page.fromJSON(data,jscape.UserInfo.fromJSON);});},getUsernames:function(){return this._request("GET","/accounts").options({global:false}).matrix({names:true}).send().then(function(data){return(data||[]).sort();});},getUser:function(username){return this._request("GET","/accounts/{account}").uri({account:username}).send().then(function(data){return jscape.UserData.fromJSON(data);});},getUserThemeNames:function(){return this._request("GET","/account/theme-names").send();},getPersonalInfo:function(name,options){return this._request("GET","/account/personal-info").matrix({username:!!name}).options(options).send().then(function(data){return jscape.PersonalInfoData.fromJSON(data);});},setPersonalInfo:function(data){return this._request("PUT","/account/personal-info").send(data);},addUser:function(data,templateName){return this._request("POST","/accounts").headers({"x-js-template":templateName}).send(data).then(function(data){return jscape.UserInfo.fromJSON(data);});},updateUser:function(username,data){return this._request("PUT","/accounts/{account}").uri({account:username}).send(data).then(function(data){return jscape.UserInfo.fromJSON(data);});},deleteUser:function(username){return this._request("DELETE","/accounts/{account}").uri({account:username}).send();},changeUserPassword:function(username,oldPassword,newPassword,resetRequired){return this._request("POST","/accounts/{account}/changepassword").uri({account:username}).matrix({resetRequired:!!resetRequired}).send({oldPassword:oldPassword,newPassword:newPassword});},testPasswordCompliance:function(username,password){return this._request("POST","/compliance/test-pwd").sendSync({account:username,password:password});},resetUserOtp:function(username){return this._request("POST","/accounts/{account}/resetotp").uri({account:username}).send();},getUserQuota:function(username){return this._request("GET","/accounts/{account}/quota").uri({account:username}).send().then(function(data){return jscape.UserQuotaInfo.fromJSON(data);});},getUserTemplateNames:function(){return this._request("GET","/account-templates").send();},getUserTemplate:function(templateName){return this._request("GET","/account-templates/{template}").uri({template:templateName}).send().then(function(data){return jscape.UserData.fromJSON(data);});},getGroupNames:function(){return this._request("GET","/groups").send();},getNetworkStorageNames:function(){return this._request("GET","/network-storage").options({global:false}).matrix({names:true}).send();},listDirectoryMonitors:function(username,startIndex,count,query){return this._request("GET","/accounts/{account}/dir-monitors").options({global:false}).uri({account:username}).matrix({start:startIndex,count:count}).send(query).then(function(data){return jscape.Page.fromJSON(data,jscape.DirectoryMonitorInfo.fromJSON);});},listContacts:function(startIndex,count,query){return this._request("GET","/v2/contacts").matrix({start:startIndex,count:count}).send(query).then(function(data){return jscape.Page.fromJSON(data,jscape.ContactInfo.fromJSON);});},getContact:function(id){return this._request("GET","/v2/contacts/{contact}").uri({contact:id}).send().then(function(data){return jscape.ContactData.fromJSON(data);});},addContact:function(data){return this._request("POST","/v2/contacts").send(data).then(function(data){return jscape.ContactInfo.fromJSON(data);});},updateContact:function(id,data){return this._request("PUT","/v2/contacts/{contact}").uri({contact:id}).send(data).then(function(data){return jscape.ContactInfo.fromJSON(data);});},deleteContact:function(id){return this._request("DELETE","/v2/contacts/{contact}").uri({contact:id}).send();},listWebThemes:function(startIndex,count,query){return this._request("GET","/web-themes").matrix({start:startIndex,count:count}).send(query).then(function(data){return jscape.Page.fromJSON(data,jscape.WebThemeInfo.fromJSON);});},getWebThemeNames:function(){return this._request("GET","/web-themes").options({global:false}).matrix({names:true}).send().then(function(data){return(data||[]).sort();});},getWebTheme:function(themeName){return this._request("GET","/web-themes/{theme}").uri({theme:themeName}).send().then(function(data){return jscape.WebThemeData.fromJSON(data);})},addWebTheme:function(data){return this._request("POST","/web-themes").send(data).then(function(data){return jscape.WebThemeInfo.fromJSON(data);})},updateWebTheme:function(themeName,data){return this._request("PUT","/web-themes/{theme}").uri({theme:themeName}).send(data).then(function(data){return jscape.WebThemeInfo.fromJSON(data);})},deleteWebTheme:function(themeName){return this._request("DELETE","/web-themes/{theme}").uri({theme:themeName}).send();},webThemeUri:function(name){return this._request("POST","/web-themes/{theme}/uri",false).uri({theme:name}).send();},listDropZones:function(startIndex,count,query,owned){return this._request("GET","/drop-zones").matrix({start:startIndex,count:count}).send($.extend({},query,{owned:!!owned})).then(function(data){return jscape.Page.fromJSON(data,jscape.DropZoneInfo.fromJSON);});},getDropZone:function(name){return this._request("GET","/drop-zones/{zone}").uri({zone:name}).send().then(function(data){return jscape.DropZoneData.fromJSON(data);});},addDropZone:function(data){return this._request("POST","/drop-zones").send(data).then(function(data){return jscape.DropZoneInfo.fromJSON(data);});},updateDropZone:function(name,data){return this._request("PUT","/drop-zones/{zone}").uri({zone:name}).send(data).then(function(data){return jscape.DropZoneInfo.fromJSON(data);});},deleteDropZone:function(name){return this._request("DELETE","/drop-zones/{zone}").uri({zone:name}).send();},getDropZoneLink:function(name,owned){return this._request("POST","/drop-zones/{zone}/link").uri({zone:name}).matrix({owned:!!owned}).send();},listAdhocTransfers:function(startIndex,count,query){return this._request("GET","/adhoc-transfers").matrix({start:startIndex,count:count}).send(query).then(function(data){return jscape.Page.fromJSON(data,jscape.AdHocTransferSummary.fromJSON);});},getAdHocTransfer:function(transferId){return this._request("GET","/adhoc-transfers/{id}").uri({id:transferId}).send().then(function(data){return jscape.AdHocTransferSummary.fromJSON(data);});},getAdhocTransferLink:function(transferId,objectId){return this._request("POST","/adhoc-transfers/{id}/link").uri({id:transferId}).send(objectId||undefined);},extendAdHocTransfer:function(transferId,expires,transferObjectIds){return this._request("PUT","/adhoc-transfers/{id}/extend").uri({id:transferId}).send({expires:expires,objectIds:transferObjectIds||[]}).then(function(info){return jscape.AdHocTransferSummary.fromJSON(info);});},revokeAdHocTransfer:function(transferId,transferObjectIds){return this._request("PUT","/adhoc-transfers/{id}/revoke").uri({id:transferId}).send({objectIds:transferObjectIds||[]}).then(function(info){return jscape.AdHocTransferSummary.fromJSON(info);});},generateKeyPair:function(keyType,keyLength,keyCurve,fileType,filePassword){return this._request("POST","/keys/ssh/generate").sendDownload({keytype:keyType,keylength:keyLength,keycurve:keyCurve,filetype:fileType,filepassword:filePassword});},importPublicKey:function(file,type){return this._request("POST","/keys/ssh/import").sendFormMultipart({file:file,type:type});},deletePublicKey:function(){return this._request("DELETE","/keys/ssh").send();},getPgpSystemKeyNames:function(){return this._request("GET","/keys/pgp").options({global:false}).matrix({names:true}).send();},generatePgpKey:function(keyType,keyLength,keyCurve,periodDays,realName,email,password){return this._request("POST","/keys/pgp/generate").sendDownload({keytype:keyType,keylength:keyLength,keycurve:keyCurve,period:periodDays,realname:realName,email:email,filepassword:password});},importPgpKey:function(file){return this._request("POST","/keys/pgp/import").sendFormMultipart({file:file});},deletePgpKey:function(){return this._request("DELETE","/keys/pgp").send();},getDlpRuleNames:function(){return this._request("GET","/dlp-rules").options({global:false}).matrix({names:true}).send();},_request:function(method,url,parse){var req=new jscape.VersionAwareRequest(method,"/rest"+url,this.timeout,parse);req.csrf=this.csrf;return $.isPlainObject(req.csrf)?req.headers(req.csrf):req;}});jscape.VersionAwareRequest=jscape.Request.extend({send:function(data){var url=this.url||this.settings.url;if(("POST"===this.settings.type||"PUT"===this.settings.type)&&jQuery.etag[url]){this.settings.ifModified=false;this.headers({"If-Match":jQuery.etag[this.url]},false);this.settings.complete=function(jqXhr,status){var tag=jqXhr.getResponseHeader("Etag");if(tag){jQuery.etag[url]=tag;}};}else{this.settings.ifModified=true;}
return this._super(data).done(function(data){if($.isPlainObject(data)&&data.hasOwnProperty("version")){delete data.version;}
return data;});}});