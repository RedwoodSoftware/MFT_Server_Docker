/* Copyright Â© 2009-2024. Redwood Software Inc. All rights reserved. */
jscape.management.ManagementService=jscape.management.ManagementService.extend({listServerKeys:function(domainName,startIndex,count,query){return this._request("GET","/domains/{domain}/keystore/keys/server").uri({domain:domainName}).matrix({start:startIndex,count:count}).send(query).then(function(data){return jscape.Page.fromJSON(data,jscape.ServerKeySummary.fromJSON);});},getServerKeys:function(domainName,algorithm){var query=!!algorithm?{field:"keyAlgorithm",query:algorithm}:undefined;return this.listServerKeys(domainName,undefined,undefined,query).then(function(page){return page.records;});},importServerKey:function(domainName,alias,file,filePassword,keyAlias,keyPassword,certificateFile,certificatePassword,certificateAlias){return this._request("POST","/domains/{domain}/keystore/keys/server/{alias}/import").uri({domain:domainName,alias:alias}).sendFormMultipart({file:file,filePassword:filePassword,keyAlias:keyAlias,keyPassword:keyPassword,certificateFile:certificateFile,certificateFilePassword:certificatePassword,certificateAlias:certificateAlias}).then(function(data){return jscape.ServerKeySummary.fromJSON(data);});},importServerKeyCertificates:function(domainName,alias,file,filePassword,keyAlias){return this._request("POST","/domains/{domain}/keystore/keys/server/{alias}/import-crt").uri({domain:domainName,alias:alias}).sendFormMultipart({file:file,filePassword:filePassword,keyAlias:keyAlias}).then(function(data){return jscape.ServerKeySummary.fromJSON(data);});},importServerKeysBatch:function(domainName,file,overwrite){return this._request("POST","/domains/{domain}/keystore-service/import/server").uri({domain:domainName}).sendFormMultipart({file:file,overwrite:!!overwrite});},exportServerPublicKey:function(domainName,alias,format,filename){return this._request("GET","/domains/{domain}/keystore/keys/server/{alias}/export-pub").uri({domain:domainName,alias:alias}).sendDownload({format:format,filename:filename});},exportServerPrivateKey:function(domainName,alias,format,password,filename){return this._request("POST","/domains/{domain}/keystore/keys/server/{alias}/export-prv").uri({domain:domainName,alias:alias}).sendDownload({format:format,filename:filename,filePassword:password});},exportServerCertificate:function(domainName,alias,format,filename){return this._request("GET","/domains/{domain}/keystore/keys/server/{alias}/export-crt").uri({domain:domainName,alias:alias}).sendDownload({format:format,filename:filename});},generateServerKey:function(domainName,alias,data){return this._request("POST","/domains/{domain}/keystore/keys/server/{alias}/generate").uri({domain:domainName,alias:alias}).sendForm(data).then(function(data){return jscape.ServerKeySummary.fromJSON(data);});},generateCertificateRevocationList:function(domainName,signingKey,expires){return this._request("POST","/domains/{domain}/keystore/crl/generate").uri({domain:domainName}).send({signingKeyAlias:signingKey,expirationPeriodDays:expires});},verifyCertificateRevocation:function(domainName,file,certificateType){return this._request("POST","/domains/{domain}/keystore/crl/verify").uri({domain:domainName}).sendFormMultipart({file:file,certificateType:certificateType});},getServerKeyView:function(domainName,alias){return this._request("GET","/domains/{domain}/keystore/keys/server/{alias}").uri({domain:domainName,alias:alias}).send({"pretty-print":true});},generateServerKeyCSR:function(domainName,alias,filename){return this._request("GET","/domains/{domain}/keystore/keys/server/{alias}/generate-csr").uri({domain:domainName,alias:alias}).sendDownload({filename:filename});},generateServerKeyCertificate:function(domainName,alias,data){return this._request("POST","/domains/{domain}/keystore/keys/server/{alias}/generate-cert").uri({domain:domainName,alias:alias}).sendForm(data).then(function(data){return jscape.ServerKeySummary.fromJSON(data);});},setServerKeyRevocationStatus:function(domainName,alias,revoked){return this._request("POST","/domains/{domain}/keystore/keys/server/{alias}/revoke").uri({domain:domainName,alias:alias}).send(!!revoked);},keyUsage:function(domainName,alias){return this._request("POST","/domains/{domain}/keystore/key-usage").uri({domain:domainName}).send(alias);},validateAlternativeName:function(domainName,value){return this._request("POST","/domains/{domain}/keystore/validate/alternative-name",false).uri({domain:domainName}).sendSync(value);},deleteServerKey:function(domainName,alias){return this._request("DELETE","/domains/{domain}/keystore/keys/server/{alias}").uri({domain:domainName,alias:alias}).send();},listClientPublicKeys:function(domainName,startIndex,count,query){return this._request("GET","/domains/{domain}/keystore/keys/client").uri({domain:domainName}).matrix({start:startIndex,count:count}).send(query).then(function(data){return jscape.Page.fromJSON(data,jscape.PublicKeySummary.fromJSON);});},listClientCertificates:function(domainName,startIndex,count,query){return this._request("GET","/domains/{domain}/keystore/certificates/client").uri({domain:domainName}).matrix({start:startIndex,count:count}).send(query).then(function(data){return jscape.Page.fromJSON(data,jscape.CertificateSummary.fromJSON);});},getClientPublicKeys:function(domainName){return this.listClientPublicKeys(domainName).then(page=>{if(page.records.length<page.totalRecords){return this.listClientPublicKeys(domainName,0,page.totalRecords).then(fullPage=>{return fullPage.records;});}
return page.records;});},getClientCertificates:function(domainName){return this.listClientCertificates(domainName).then(function(page){return page.records;});},getClientCertificate:function(domainName,alias){return this._request("GET","/domains/{domain}/keystore/certificates/client/{alias}").uri({domain:domainName,alias:alias}).send().then(function(data){return jscape.CertificateSummary.fromJSON(data);});},generateClientKey:function(domainName,alias,data){return this._request("POST","/domains/{domain}/keystore/keys/client/{alias}/generate").uri({domain:domainName,alias:alias}).sendDownload(data);},getClientKeyView:function(domainName,alias){return this._request("GET","/domains/{domain}/keystore/keys/client/{alias}").uri({domain:domainName,alias:alias}).send({"pretty-print":true})},getClientCertificateView:function(domainName,alias){return this._request("GET","/domains/{domain}/keystore/certificates/client/{alias}").uri({domain:domainName,alias:alias}).send({"pretty-print":true});},setClientCertificateRevocationStatus:function(domainName,alias,revoked){return this._request("POST","/domains/{domain}/keystore/certificates/client/{alias}/revoke").uri({domain:domainName,alias:alias}).send(!!revoked);},importClientKey:function(domainName,alias,file){return this._request("POST","/domains/{domain}/keystore/keys/client/{alias}/import").uri({domain:domainName,alias:alias}).sendFormMultipart({file:file}).then(function(data){return jscape.CertificateSummary.isCertificateData(data)?jscape.CertificateSummary.fromJSON(data):jscape.PublicKeySummary.fromJSON(data);});},importClientKeysBatch:function(domainName,file,overwrite){return this._request("POST","/domains/{domain}/keystore-service/import/client").uri({domain:domainName}).sendFormMultipart({file:file,overwrite:!!overwrite});},importClientKeyTsl:function(domainName,url){return this._request("POST","/domains/{domain}/keystore/keys/client/{alias}/import-tsl").uri({domain:domainName,alias:"oftp"}).send(url);},exportClientPublicKey:function(domainName,alias,format,filename){return this._request("GET","/domains/{domain}/keystore/keys/client/{alias}/export").uri({domain:domainName,alias:alias}).sendDownload({format:format,filename:filename});},exportClientCertificatePublicKey:function(domainName,alias,format,filename){return this._request("GET","/domains/{domain}/keystore/certificates/client/{alias}/export-pub").uri({domain:domainName,alias:alias}).sendDownload({format:format,filename:filename})},exportClientCertificate:function(domainName,alias,format,filename){return this._request("GET","/domains/{domain}/keystore/certificates/client/{alias}/export").uri({domain:domainName,alias:alias}).sendDownload({format:format,filename:filename});},deleteClientCertificate:function(domainName,alias){return this._request("DELETE","/domains/{domain}/keystore/certificates/client/{alias}").uri({domain:domainName,alias:alias}).send();},deleteClientPublicKey:function(domainName,alias){return this._request("DELETE","/domains/{domain}/keystore/keys/client/{alias}").uri({domain:domainName,alias:alias}).send();},listHostPublicKeys:function(domainName,startIndex,count,query){return this._request("GET","/domains/{domain}/keystore/keys/host").uri({domain:domainName}).matrix({start:startIndex,count:count}).send(query).then(function(data){return jscape.Page.fromJSON(data,jscape.PublicKeySummary.fromJSON);});},listHostCertificates:function(domainName,startIndex,count,query){return this._request("GET","/domains/{domain}/keystore/certificates/host").uri({domain:domainName}).matrix({start:startIndex,count:count}).send(query).then(function(data){return jscape.Page.fromJSON(data,jscape.CertificateSummary.fromJSON);});},getHostPublicKeys:function(domainName){return this.listHostPublicKeys(domainName).then(function(page){return page.records;});},getHostCertificates:function(domainName,algorithm){var query=!!algorithm?{field:"keyAlgorithm",query:algorithm}:undefined;return this.listHostCertificates(domainName,undefined,undefined,query).then(function(page){return page.records;});},getHostKeyView:function(domainName,alias){return this._request("GET","/domains/{domain}/keystore/keys/host/{alias}").uri({domain:domainName,alias:alias}).send({"pretty-print":true});},getHostCertificateView:function(domainName,alias){return this._request("GET","/domains/{domain}/keystore/certificates/host/{alias}").uri({domain:domainName,alias:alias}).send({"pretty-print":true});},importHostKey:function(domainName,alias,file){return this._request("POST","/domains/{domain}/keystore/keys/host/{alias}/import").uri({domain:domainName,alias:alias}).sendFormMultipart({file:file}).then(function(data){return jscape.CertificateSummary.isCertificateData(data)?jscape.CertificateSummary.fromJSON(data):jscape.PublicKeySummary.fromJSON(data);});},importHostKeysBatch:function(domainName,file,overwrite){return this._request("POST","/domains/{domain}/keystore-service/import/host").uri({domain:domainName}).sendFormMultipart({file:file,overwrite:!!overwrite});},importHostKeyTsl:function(domainName,url){return this._request("POST","/domains/{domain}/keystore/keys/host/{alias}/import-tsl").uri({domain:domainName,alias:"oftp"}).send(url);},exportHostCertificatePublicKey:function(domainName,alias,format,filename){return this._request("GET","/domains/{domain}/keystore/certificates/host/{alias}/export-pub").uri({domain:domainName,alias:alias}).sendDownload({format:format,filename:filename});},exportHostPublicKey:function(domainName,alias,format,filename){return this._request("GET","/domains/{domain}/keystore/keys/host/{alias}/export").uri({domain:domainName,alias:alias}).sendDownload({format:format,filename:filename});},exportHostCertificate:function(domainName,alias,format,filename){return this._request("GET","/domains/{domain}/keystore/certificates/host/{alias}/export").uri({domain:domainName,alias:alias}).sendDownload({format:format,filename:filename});},setHostCertificateRevocationStatus:function(domainName,alias,revoked){return this._request("POST","/domains/{domain}/keystore/certificates/host/{alias}/revoke").uri({domain:domainName,alias:alias}).send(!!revoked);},deleteHostCertificate:function(domainName,alias){return this._request("DELETE","/domains/{domain}/keystore/certificates/host/{alias}").uri({domain:domainName,alias:alias}).send();},deleteHostPublicKey:function(domainName,alias){return this._request("DELETE","/domains/{domain}/keystore/keys/host/{alias}").uri({domain:domainName,alias:alias}).send();},listPgpPublicKeys:function(domainName,startIndex,count,query){return this._request("GET","/domains/{domain}/keystore/keys/pgp/public").uri({domain:domainName}).matrix({start:startIndex,count:count}).send(query).then(function(data){return jscape.Page.fromJSON(data,jscape.PgpKeySummary.fromJSON);});},listPgpSecretKeys:function(domainName,startIndex,count,query){return this._request("GET","/domains/{domain}/keystore/keys/pgp/secret").uri({domain:domainName}).matrix({start:startIndex,count:count}).send(query).then(function(data){return jscape.Page.fromJSON(data,jscape.PgpKeySummary.fromJSON);});},getPgpPublicKeys:function(domainName){return this.listPgpPublicKeys(domainName).then(function(page){return page.records;});},getPgpSecretKeys:function(domainName){return this.listPgpSecretKeys(domainName).then(function(page){return page.records;});},importPgpSecretKey:function(domainName,file,password){return this._request("POST","/domains/{domain}/keystore/keys/pgp/secret/import").uri({domain:domainName}).sendFormMultipart({file:file,filePassword:password}).then(function(data){return jscape.PgpKeySummary.fromJSON(data);});},importPgpPublicKey:function(domainName,file){return this._request("POST","/domains/{domain}/keystore/keys/pgp/public/import").uri({domain:domainName}).sendFormMultipart({file:file}).then(function(data){return jscape.PgpKeySummary.fromJSON(data);});},importPgpPublicKeysBatch:function(domainName,file,overwrite){return this._request("POST","/domains/{domain}/keystore-service/import/pgp/public").uri({domain:domainName}).sendFormMultipart({file:file,overwrite:!!overwrite})},importPgpSecretKeysBatch:function(domainName,file,overwrite){return this._request("POST","/domains/{domain}/keystore-service/import/pgp/secret").uri({domain:domainName}).sendFormMultipart({file:file,overwrite:!!overwrite})},exportPgpSecretPublicKey:function(domainName,alias,filename){return this._request("GET","/domains/{domain}/keystore/keys/pgp/secret/{alias}/export-pub").uri({domain:domainName,alias:alias}).sendDownload({filename:filename})},exportPgpPublicKey:function(domainName,alias,filename){return this._request("GET","/domains/{domain}/keystore/keys/pgp/public/{alias}/export").uri({domain:domainName,alias:alias}).sendDownload({filename:filename})},exportPgpSecretKey:function(domainName,alias,filename,password){return this._request("POST","/domains/{domain}/keystore/keys/pgp/secret/{alias}/export").uri({domain:domainName,alias:alias}).sendDownload({filename:filename,password:password});},generatePgpKey:function(domainName,realName,email,keyType,keyLength,keyCurve,periodDays){return this._request("POST","/domains/{domain}/keystore/keys/pgp/generate").uri({domain:domainName}).sendForm({realName:realName,email:email,keyType:keyType,keyLength:keyLength,keyCurve:keyCurve,period:periodDays}).then(function(data){return jscape.PgpKeySummary.fromJSON(data);});},signPgpPublicKey:function(domainName,alias,secretKeyAlias){return this._request("PUT","/domains/{domain}/keystore/keys/pgp/public/{alias}/sign?secretKeyAlias={ska}").uri({domain:domainName,alias:alias,ska:secretKeyAlias}).send().then(function(data){return jscape.PgpKeySummary.fromJSON(data);});},getPgpSecretKeySignatures:function(domainName,alias){return this._request("GET","/domains/{domain}/keystore/keys/pgp/secret/{alias}/signatures").uri({domain:domainName,alias:alias}).send().then(function(data){return $.map(data||[],jscape.PgpSignatureDescriptor.fromJSON);});},getPgpPublicKeySignatures:function(domainName,alias){return this._request("GET","/domains/{domain}/keystore/keys/pgp/public/{alias}/signatures").uri({domain:domainName,alias:alias}).send().then(function(data){return $.map(data||[],jscape.PgpSignatureDescriptor.fromJSON);});},deletePgpPublicKey:function(domainName,alias){return this._request("DELETE","/domains/{domain}/keystore/keys/pgp/public/{alias}").uri({domain:domainName,alias:alias}).send();},deletePgpSecretKey:function(domainName,alias){return this._request("DELETE","/domains/{domain}/keystore/keys/pgp/secret/{alias}").uri({domain:domainName,alias:alias}).send();}});