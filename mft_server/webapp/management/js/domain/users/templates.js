/* Copyright Â© 2009-2024. Redwood Software Inc. All rights reserved. */
jscape.domain=jscape.domain||{};jscape.AccountTemplateInfo=Class.extend({initialize:function(a,b){this.name=a||"";this.tags=b||[];},isDefault:function(){return"DEFAULT"===(this.name||"").toUpperCase();}});jscape.AccountTemplateInfo.fromJSON=function(data){return data?new jscape.AccountTemplateInfo(data.name,data.tags):null;};jscape.AccountTemplate=Class.extend({initialize:function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t){this.name=a||"";this.username=b||"";this.emailAddress=c||"";this.company=d||null;this.phone=e||null;this.owner=f||"";this.expirationDate=g||null;this.expirationPeriodMillis=h||null;this.enabled=i!=undefined?!!i:true;this.secured=j||false;this.groups=k||[];this.allowedProtocols=l||null;this.bindedKeys=m||[];this.passwordChangingAllowed=n||false;this.emailFileTransferAllowed=o||false;this.adHocTransferPermissions=p||[];this.usePhoneAuthentication=q||false;this.sftpPublicKeyAuthenticationRequired=!!r;this.ignorePasswordAgingRules=s||false;this.resources=[];this.quotas=new jscape.AccountTransferQuotas();this.ipAccessVerifier=new jscape.IpAccessVerifier();this.administration=null;this.webOptions=new jscape.WebOptions();this.tags=t||[];},toJSON:function(){return $.extend({},this,{expirationDate:this.expirationDate?this.expirationDate.getTime():null,quotas:undefined,webOptions:undefined},JSON.parse(JSON.stringify(this.quotas)),JSON.parse(JSON.stringify(this.webOptions)));}});jscape.AccountTemplate.fromJSON=function(data){return $.extend(new jscape.AccountTemplate(),data,{phone:jscape.Phone.fromJSON(data.phone),groups:$.isArray(data.groups)?data.groups:[],allowedProtocols:$.isArray(data.allowedProtocols)?data.allowedProtocols:null,expirationDate:$.isNumeric(data.expirationDate)?new Date(data.expirationDate):null,expirationPeriodMillis:$.isNumeric(data.expirationPeriodMillis)?parseInt(data.expirationPeriodMillis):null,resources:$.map(data.resources||[],jscape.VirtualFile.fromJSON),quotas:jscape.AccountTransferQuotas.fromJSON(data),ipAccessVerifier:jscape.IpAccessVerifier.fromJSON(data.ipAccessVerifier),administration:jscape.DomainAdministration.fromJSON(data.administration),adHocTransferPermissions:$.isArray(data.adHocTransferPermissions)?data.adHocTransferPermissions:[],webOptions:jscape.WebOptions.fromJSON(data),tags:$.isArray(data.tags)?data.tags:[]});};jscape.domain.AccountTemplatesController=jscape.ui.DatagridController.extend({view:null,variables:null,initialize:function(){this._initValidators();this.variables=[];},onCreate:function(domainName){this.domainName=domainName;this.addController=new jscape.domain.AddAccountTemplateController();this.editController=new jscape.domain.EditAccountTemplateController();this.deleteController=new jscape.domain.DeleteAccountTemplateController();},onStart:function(){if(this.view==null){this.view=new jscape.domain.AccountTemplatesView();jscape.API.getAccountTemplateVariables(this.domainName).then($.proxy(function(items){this.variables=items;},this));}
this.view.show(this);},onResume:function(){this.view.refresh();},onLoadData:function(params){params=jscape.Page.requestParameters(params);return jscape.API.listAccountTemplates(this.domainName,params.startIndex,params.count,params.query).then(jscape.Page.datagridFormatter());},onAddTemplate:function(){this.addController.start(this.domainName,this.variables).done($.proxy(this._templateAdded,this));},onEditTemplate:function(template){var index=$.inArray(template,this.view.getTemplates());if(index!=-1){this.editController.start(this.domainName,template.name,this.variables).done($.proxy(this._templateEdited,this,index));}},onDeleteTemplate:function(template){this.deleteController.start(this.domainName,template.name).done($.proxy(this._templateDeleted,this,template));},_templateAdded:function(template){this._recordAdded(template);},_templateEdited:function(index,template){this._recordEdited(template);},_templateDeleted:function(template){this._recordDeleted(template);},_initValidators:function(){var v=new jscape.Validator();v.rule("usertemplate_unique",$.proxy(this._templateNotExists,this),window.R.string.USER_TEMPLATES_ERROR_ALREADY_EXIST);},_templateNotExists:function(value){var names=$.map(this.view.getTemplates(),function(template){return template.name.toUpperCase();});return $.inArray((value||"").toUpperCase(),names)==-1;}});jscape.domain.AccountTemplatesView=jscape.ui.DatagridView.extend({selection:null,initialize:function(){var initializing=true;this.fieldset=$("#user-templates-fields").layout({fit:true,doSize:false,border:false});this.data=$("table[role=grid][aria-label=usertemplates]",this.fieldset);this.data.datagrid({fit:true,fitColumns:true,singleSelect:true,ctrlSelect:true,pagination:true,search:true,remoteSearch:true,remoteSort:false,idField:"name",sortName:"name",columns:[[{field:"name",title:$("thead th:nth-child(1)",this.data).text(),sortable:true,width:"60%"},{field:"tags",title:$("thead th:nth-child(2)",this.data).text(),width:"40%",formatter:function(value){return String($.isArray(value)?value.join(", "):value).escapeXml();}}]],onSelect:$.proxy(this._adjustState,this),onUnselect:$.proxy(this._adjustState,this),onUnselectAll:$.proxy(this._adjustState,this),onDblClickRow:$.proxy(this._onClick$EditButton,this),onRowContextMenu:$.proxy(this._onRow$ContextMenu,this),onBeforeLoad:function(){return!initializing;},loader:$.proxy(this._onLoad$Data,this),onLoadSuccess:$.proxy(this._adjustState,this)});this.addButton=$("a[role=button][name=add]",this.fieldset).linkbutton({onClick:$.proxy(this._onClick$AddButton,this)});this.editButton=$("a[role=button][name=edit]",this.fieldset).linkbutton({disabled:true,onClick:$.proxy(this._onClick$EditButton,this)});this.deleteButton=$("a[role=button][name=delete]",this.fieldset).linkbutton({disabled:true,onClick:$.proxy(this._onClick$DeleteButton,this)});initializing=false;},show:function(listener){this.listener=listener||jscape.domain.AccountTemplatesView.LISTENER;this._adjustState();},getTemplates:function(){return this.getRecords();},_onLoad$Data:function(params,success,error){this.listener.onLoadData(params).then(success,error);},_onClick$AddButton:function(){this.listener.onAddTemplate();},_onClick$EditButton:function(){this.listener.onEditTemplate(this.selection[0]);},_onClick$DeleteButton:function(){this.listener.onDeleteTemplate(this.selection[0]);},_showContextMenu:function(e){this._super(e,[this.addButton,this.editButton,this.deleteButton]);},_adjustState:function(){this.selection=this.data.datagrid("getSelections");var defaultTemplateSelected=$.grep(this.selection,function(template){return template.isDefault();}).length!=0;this.editButton.linkbutton(this.selection.length==1?"enable":"disable");this.deleteButton.linkbutton(this.selection.length!=0&&!defaultTemplateSelected?"enable":"disable");}});jscape.domain.AccountTemplatesView.LISTENER={onLoadData:$.noop,onAddTemplate:$.noop,onEditTemplate:$.noop,onDeleteTemplate:$.noop};jscape.domain.AddAccountTemplateController=Class.extend({DEFAULT_TEMPLATE:$.extend(new jscape.AccountTemplate(),{resources:[jscape.VirtualFile.local("/",undefined,false,false,true,"%installdir%/users/%domain%/%username%",true)]}),infoController:null,vfsController:null,quotasController:null,ipAccessController:null,domainAdminController:null,webController:null,deferred:null,initialize:function(){this.variableController=new jscape.VariableController();},start:function(domainName,variables){this.domainName=domainName;this.variables=variables;this.deferred=$.Deferred();this._setupDialog().show(this);return this.deferred.promise();},onAddVariable:function(input){this.variableController.start(input,this.variables);},onSubmit:function(dialog){var template=this._createTemplate(dialog);return jscape.API.addAccountTemplate(this.domainName,template).done($.proxy(function(template){this.deferred.resolve(template);this.deferred=null;this._cleanup();},this));},onCancel:function(dialog){dialog.destroy();this._cleanup();this.deferred.reject();},_setupDialog:function(){var dialog=new jscape.domain.AddAccountTemplateDialog();this._createView(dialog);window.setTimeout($.proxy(function(){try{this._setupView(this.DEFAULT_TEMPLATE);}catch(e){dialog.destroy();this._cleanup();}finally{dialog=null;}},this),0);return dialog;},_createView:function(parent){this._cleanup();this.infoController=new jscape.domain.AddUserTemplateInfoController(parent);this.vfsController=new jscape.vfs.VirtualFilesController(parent);this.quotasController=new jscape.domain.QuotasController(parent);this.ipAccessController=new jscape.domain.UserIpAccessController(parent);this.domainAdminController=new jscape.domain.DomainAdministrationController(parent,this.vfsController);this.webController=new jscape.domain.WebOptionsController(parent);},_setupView:function(template){this.infoController.start(this.domainName);this.vfsController.start(this.domainName,template.resources,this.variables);this.quotasController.start();this.ipAccessController.start();this.domainAdminController.start(this.domainName);this.webController.start();},_createTemplate:function(dialog){var template=this.infoController.createAccountTemplate();return $.extend(template,{resources:this.vfsController.getDescriptors(),quotas:this.quotasController.getQuotas(),ipAccessVerifier:this.ipAccessController.getIpAccess(),administration:this.domainAdminController.getDomainAdministration(),webOptions:this.webController.getWebOptions()});},_cleanup:function(){this.infoController=null;this.vfsController=null;this.quotasController=null;this.ipAccessController=null;this.domainAdminController=null;this.webController=null;}});jscape.domain.EditAccountTemplateController=Class.extend({infoController:null,vfsController:null,quotasController:null,ipAccessController:null,domainAdminController:null,webController:null,deferred:null,initialize:function(){this.variableController=new jscape.VariableController();},start:function(domainName,templateName,variables){this.domainName=domainName;this.templateName=templateName;this.variables=variables;this.deferred=$.Deferred();jscape.API.getAccountTemplate(domainName,templateName).done($.proxy(function(template){this.template=template;this._setupDialog(template).show(this);},this)).fail($.proxy(function(){this.deferred.reject();this.deferred=null;},this));return this.deferred.promise();},hasChanged:function(dialog){return!!this.template&&!Object._equals(this.template,this._createTemplate(dialog));},onAddVariable:function(input){this.variableController.start(input,this.variables);},onSubmit:function(dialog){var template=this._createTemplate(dialog);return jscape.API.setTemplate(this.domainName,this.templateName,template).done($.proxy(function(template){this.deferred.resolve(template);this.deferred=null;this._cleanup();},this));},onCancel:function(dialog){dialog.destroy();this._cleanup();this.deferred.reject();},_setupDialog:function(template){var dialog=new jscape.domain.EditAccountTemplateDialog();dialog.setTemplateName(template.name);this._createView(dialog);window.setTimeout($.proxy(function(){try{this._setupView(template);}catch(e){dialog.destroy();this._cleanup();}finally{dialog=null;}},this),0);return dialog;},_createView:function(dialog){this._cleanup();this.infoController=new jscape.domain.EditUserTemplateInfoController(dialog);this.vfsController=new jscape.vfs.VirtualFilesController(dialog);this.quotasController=new jscape.domain.QuotasController(dialog);this.ipAccessController=new jscape.domain.UserIpAccessController(dialog);this.domainAdminController=new jscape.domain.DomainAdministrationController(dialog,this.vfsController);this.webController=new jscape.domain.WebOptionsController(dialog);},_setupView:function(template){this.infoController.start(this.domainName,template);this.vfsController.start(this.domainName,template.resources,this.variables);this.quotasController.start(template.quotas);this.ipAccessController.start(template.ipAccessVerifier);this.domainAdminController.start(this.domainName,template.administration);this.webController.start(template.webOptions);},_createTemplate:function(dialog){var template=this.infoController.createAccountTemplate();return $.extend(template,{resources:this.vfsController.getDescriptors(),quotas:this.quotasController.getQuotas(),ipAccessVerifier:this.ipAccessController.getIpAccess(),administration:this.domainAdminController.getDomainAdministration(),webOptions:this.webController.getWebOptions()});},_cleanup:function(){this.infoController=null;this.vfsController=null;this.quotasController=null;this.ipAccessController=null;this.domainAdminController=null;this.webController=null;}});jscape.domain.DeleteAccountTemplateController=Class.extend({deferred:null,start:function(domainName,templateName){this.domainName=domainName;this.deferred=$.Deferred();this._confirmDelete(templateName).done($.proxy(this._deleteConfirmed,this,templateName)).fail($.proxy(function(){this.deferred.reject();this.deferred=null;},this));return this.deferred.promise();},_confirmDelete:function(templateName){return jscape.ConfirmDialog.confirm(window.R.string.USER_TEMPLATES_CONFIRM_DELETE_TITLE,window.R.string.USER_TEMPLATES_CONFIRM_DELETE_MESSAGE.supplant({0:templateName}));},_deleteConfirmed:function(templateName){$.when.apply(jQuery,[jscape.API.deleteTemplate(this.domainName,templateName)]).done($.proxy(function(){this.deferred.resolve();this.deferred=null;},this)).fail($.proxy(function(){this.deferred.reject();this.deferred=null;},this));}});jscape.domain.AccountTemplateDialog=jscape.ui.DefaultDialog.extend({focusInField:null,initialize:function(dialog){this._super(dialog,{width:"75%",height:"90%",minHeight:600,doSize:false,maximizable:true});this.tabs=$("div[role=tablist]",this.dialog).tabs({fit:true,doSize:false,plain:true,tabPosition:"top"});this.addVariableButton=$("a[role=button][name=addvar]",this.dialog).linkbutton({disabled:true,onClick:$.proxy(this._onClick$AddVariableButton,this)});this.dialog.focusin($.proxy(function(e){var target=$(e.target);if(target.is(this.addVariableButton)){return;}
if(target.is(":input[type=text], textarea")&&target.is(":not(.numberbox):not([readonly])")){this.focusInField=target;}else{this.focusInField=null;}
this._onChange$FocusInField();},this)).focusout($.proxy(function(e){if($(e.target).is(this.focusInField)&&$(e.relatedTarget).is(this.addVariableButton)){return;}
this.focusInField=null;this._onChange$FocusInField();},this));},show:function(listener){this._super(listener);this.dialog.dialog("resize");},_onClick$AddVariableButton:function(){if(this.focusInField&&this.focusInField.length&&this.focusInField.is(":visible")){this.addVariableButton.linkbutton("disable");this.listener.onAddVariable(this.focusInField);}},_onChange$FocusInField:function(){this.addVariableButton.linkbutton(this.focusInField!=null?"enable":"disable");},_valid:function(){return new jscape.Validator().validateTabs(this.tabs,false);}});jscape.domain.AddAccountTemplateDialog=jscape.domain.AccountTemplateDialog.extend({initialize:function(){this._super($("#d-usertemplate-add"));}});jscape.domain.EditAccountTemplateDialog=jscape.domain.AccountTemplateDialog.extend({initialize:function(){this._super($("#d-usertemplate-edit"));this.title=this.dialog.dialog("header").text()||"";},setTemplateName:function(value){this.dialog.dialog("setTitle",this.title.supplant({0:value}));}});jscape.domain.BaseUserTemplateInfoController=Class.extend({onAddTag:function(value){return jscape.API.storeAclTag(value);},onLoadTags:function(){return jscape.API.getDomainTags(this.domainName);},onLoadGroups:function(){return jscape.API.getGroupNames(this.domainName);},onLoadClientKeys:function(){return $.when(jscape.API.getClientPublicKeys(this.domainName),jscape.API.getClientCertificates(this.domainName)).then(function(publicKeys,certificates){publicKeys=$.map(publicKeys,function(key){return key.name;});certificates=$.map(certificates,function(key){return key.name;});return publicKeys.concat(certificates);});},onAdHocSettings:function(view){return new jscape.domain.AdHocTransferPermissionsController().start(view.getAdHocTransferPermissions()).done(function(data){view.setAdHocTransferPermissions(data);view.setAllowAdHocTransfers(data&&data.length!=0);});}});jscape.domain.AddUserTemplateInfoController=jscape.domain.BaseUserTemplateInfoController.extend({initialize:function(dialog){this.view=new jscape.domain.AddUserTemplateInfoView(dialog);},start:function(domainName){this.domainName=domainName;this.view.show(this);this._setupView();},createAccountTemplate:function(){var company=this.view.getCompany().trim().length?this.view.getCompany():null;var phone=$.isNumeric(this.view.getPhoneCode())?new jscape.Phone(this.view.getPhoneCode(),this.view.getPhoneNumber(),this.view.getPhoneExtension()):null;return new jscape.AccountTemplate(this.view.getName(),this.view.getUsername(),this.view.getEmail(),company,phone,this.view.getOwner(),this.view.getExpirationDate(),this.view.getExpiresAfterPeriod(),this.view.getEnabled(),this.view.getSecured(),this.view.getGroups(),this.view.getProtocols(),this.view.getClientKeys(),this.view.getAllowPasswordChanging(),this.view.getAllowAdHocTransfers(),this.view.getAdHocTransferPermissions(),this.view.getUseMultiFactorAuthentication(),this.view.isSftpPublicKeyAuthRequired(),this.view.getIgnorePasswordAgingRules(),this.view.getTags());},_setupView:function(){this.view.setEnabled(true);this.view.setAllowAdHocTransfers(true);this.view.setAdHocTransferPermissions("EXTERNAL");this.view.setSecured(true);this.view.setAllowPasswordChanging(true);this.view.setGroups([]);this.view.setProtocols(null);this.view.setClientKeys([]);jscape.API.getAccountAdminNames(this.domainName).done($.proxy(function(owners){this.view.setAvailableOwners(owners);},this));jscape.API.getDomainTags(this.domainName).done($.proxy(function(tags){this.view.setTags(tags);},this));}});jscape.domain.EditUserTemplateInfoController=jscape.domain.BaseUserTemplateInfoController.extend({initialize:function(dialog){this.view=new jscape.domain.EditUserTemplateInfoView(dialog);},start:function(domainName,template){this.domainName=domainName;this.templateName=template.name;this.view.show(this);this._setupView(template);},createAccountTemplate:function(){var company=this.view.getCompany().trim().length?this.view.getCompany():null;var phone=$.isNumeric(this.view.getPhoneCode())?new jscape.Phone(this.view.getPhoneCode(),this.view.getPhoneNumber(),this.view.getPhoneExtension()):null;return new jscape.AccountTemplate(this.templateName,this.view.getUsername(),this.view.getEmail(),company,phone,this.view.getOwner(),this.view.getExpirationDate(),this.view.getExpiresAfterPeriod(),this.view.getEnabled(),this.view.getSecured(),this.view.getGroups(),this.view.getProtocols(),this.view.getClientKeys(),this.view.getAllowPasswordChanging(),this.view.getAllowAdHocTransfers(),this.view.getAdHocTransferPermissions(),this.view.getUseMultiFactorAuthentication(),this.view.isSftpPublicKeyAuthRequired(),this.view.getIgnorePasswordAgingRules(),this.view.getTags());},_setupView:function(template){if(template){this.view.setUsername(template.username);this.view.setEmail(template.emailAddress);this.view.setCompany(template.company!=null?template.company.name:"");if(template.phone!=null){this.view.setPhoneCode(template.phone.code);this.view.setPhoneNumber(template.phone.number);this.view.setPhoneExtension(template.phone.extension);}
this.view.setExpirationDate(template.expirationDate);this.view.setExpiresAfterPeriod(template.expirationPeriodMillis);this.view.setEnabled(template.enabled);this.view.setSecured(template.secured);this.view.setUseMultiFactorAuthentication(template.usePhoneAuthentication);this.view.setSftpPublicKeyAuthRequired(template.sftpPublicKeyAuthenticationRequired);this.view.setAllowAdHocTransfers(template.emailFileTransferAllowed);this.view.setAdHocTransferPermissions(template.adHocTransferPermissions);this.view.setAllowPasswordChanging(template.passwordChangingAllowed);this.view.setIgnorePasswordAgingRules(template.ignorePasswordAgingRules);this.view.setGroups(template.groups||[]);this.view.setProtocols(template.allowedProtocols);this.view.setClientKeys(template.bindedKeys||[]);this.view.setTags(template.tags);}
jscape.API.getAccountAdminNames(this.domainName).done($.proxy(function(owners){this.view.setAvailableOwners(owners);template&&this.view.setOwner(template.owner);},this));}});jscape.domain.UserTemplateInfoView=jscape.domain.UserInfoView.extend({initialize:function(fieldset){this._super(fieldset);this.expires=$("input[name=expires]",this.fieldset).change($.proxy(function(){var enabled=this.expires.is(":checked");this.expirationDate.datebox(enabled?"enable":"disable").datebox(enabled?"enableValidation":"disableValidation");this.expiresAfter.prop("disabled",this.expires.is(":checked:not(:disabled)"));},this));this.expirationDate=$("input[name=expirationdate]",this.fieldset);this.expirationDate.datebox({required:true,editable:false,disabled:true,width:120,formatter:function(date){return jscape.DateFormat.format(date,"{MM}/{dd}/{yy}");},parser:function(text){var matches=/(\d{1,2})\/(\d{1,2})\/(\d{2,4})/.exec(text);if(matches!=null&&matches.length==4){var m=parseInt(matches[1],10),d=parseInt(matches[2],10),y=parseInt(matches[3],10);if(!isNaN(d)&&!isNaN(m)&&!isNaN(y)){return new Date(y,m-1,d);}}
return new Date();}});this.expirationDate.datebox("calendar").calendar({validator:function(date){var now=new Date();now.setHours(date.getHours());now.setMinutes(date.getMinutes());now.setSeconds(date.getSeconds());now.setMilliseconds(date.getMilliseconds());return now.getTime()<=date.getTime();}});this.expirationDate.datebox("setDate",new Date());this.expiresAfter=$("input[name=expiresafter]:checkbox",this.fieldset).change($.proxy(function(){var enabled=this.expiresAfter.is(":checked");this.expiresAfterPeriod.numberspinner(enabled?"enable":"disable").numberspinner(enabled?"enableValidation":"disableValidation");this.expiresAfterUnit.combobox(enabled?"enable":"disable").combobox(enabled?"enableValidation":"disableValidation");this.expires.prop("disabled",this.expiresAfter.is(":checked:not(:disabled)"));},this));this.expiresAfterPeriod=$("input[name=expiresafterperiod]",this.fieldset).numberspinner({min:1,max:1000,step:1,value:1,disabled:true,width:90});this.expiresAfterUnit=$("select[name=expiresafterunit]",this.fieldset).combobox({required:true,editable:false,disabled:true,panelHeight:"auto",width:90});this.useMultiFactorAuth=$("input[name=multifactorauth]:checkbox",this.fieldset);$("a[role=button][name=resettotp]",this.fieldset).hide();this.sftpPublicKeyAuth=$("input[name=sftppublickeyauth]:checkbox",this.fieldset);},getExpirationDate:function(){return this.expires.is(":checked:not(:disabled)")?this.expirationDate.datebox("getDate"):null;},setExpirationDate:function(value){if(value!=null){this.expires.prop("checked",true).change();this.expirationDate.datebox("setDate",value).datebox("enable");}else{this.expires.prop("checked",false).change();this.expirationDate.datebox("setDate",new Date());}},getExpiresAfterPeriod:function(){if(this.expiresAfter.is(":checked:not(:disabled)")){var factor=parseInt(this.expiresAfterUnit.combobox("getValue"));return parseInt(this.expiresAfterPeriod.numberspinner("getValue"))*factor;}
return null;},setExpiresAfterPeriod:function(value){if(value!=null){var factor=$.fn._unitValueFor(this.expiresAfterUnit,value);this.expiresAfter.prop("checked",true).change();this.expiresAfterPeriod.numberspinner("setValue",value/factor);this.expiresAfterUnit.combobox("select",factor+"");}else{this.expiresAfter.prop("checked",false).change();}},getUseMultiFactorAuthentication:function(){return this.useMultiFactorAuth.is(":checked");},setUseMultiFactorAuthentication:function(value){this.useMultiFactorAuth.prop("checked",!!value)},isSftpPublicKeyAuthRequired:function(){return this.sftpPublicKeyAuth.is(":checked");},setSftpPublicKeyAuthRequired:function(value){this.sftpPublicKeyAuth.prop("checked",!!value).change();}});jscape.domain.AddUserTemplateInfoView=jscape.domain.UserTemplateInfoView.extend({initialize:function(dialog){this._super($("#templateinfoaddfields"+dialog.getIdSuffix()));this.name=$("input[name=name]",this.fieldset).textbox({required:true,validType:["non_empty","usertemplate_unique"],missingMessage:window.R.string.USER_TEMPLATES_ERROR_BAD_NAME,invalidMessage:window.R.string.USER_TEMPLATES_ERROR_BAD_NAME,width:"60%"});},getName:function(){return this.name.textbox("getValue");}});jscape.domain.EditUserTemplateInfoView=jscape.domain.UserTemplateInfoView.extend({initialize:function(dialog){this._super($("#templateinfoeditfields"+dialog.getIdSuffix()));}});